@task
def map_{{encode_target}}_fun():

    in_dataset = '{{ input[0] | default('NA',true) }}'
    out_dataset = '{{ output[0] | default('NA',true) }}'
    target = '{{encode_target}}'
    encode_map = {}
{% for key in map %}
    encode_map['{{key}}'] = {{map[key]}} 
{% endfor %}

    print( """ Maping data with parameters:
                in_dataset: {} 
                out_dataset: {}
                target: {}
                map: {}""".format(in_dataset,out_dataset,target,encode_map) )

    #Here we should change to get the host from template arguments and better way to send arguments
    url = 'http://ejecutor:4001/ejecutarpython/encode_categorical.py'
    body = {'parametros': ['{}.csv'.format(in_dataset),target,'{}.csv'.format(out_dataset)] }

    x = requests.post(url, json = body)

    print(x.text)